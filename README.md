# Shadow Orography Studio

Desktop application and computational engine for yearly worst-case wind turbine shadow intersection analysis on polygon AOI.

## Troubleshooting executable startup on Windows

If `ShadowOrography.exe` closes immediately (also when launched from `cmd`/PowerShell), use this workflow:

1. Run the executable from terminal to capture stderr:
   - `ShadowOrography.exe`
2. Open the startup log generated by the app:
   - Default path: `%TEMP%\shadow_orography_startup.log`
   - Example: `C:\Users\<user>\AppData\Local\Temp\shadow_orography_startup.log`
3. Look for `Fatal startup error` and the Python traceback.

### Typical causes and fixes

- **Missing Visual C++ runtime**: install/repair "Microsoft Visual C++ Redistributable 2015-2022" (x64).
- **Qt plugin not found (`platforms/qwindows`)**: verify packaging includes `PySide6/plugins/platforms`.
- **Blocked by antivirus/SmartScreen**: whitelist executable and app folder, then retry.
- **Corrupted config/project path**: start without loading project and re-open a valid JSON/shapefile.

### Extra debug option

You can override the startup log path (useful in CI or support scripts):

- `set SHADOW_OROGRAPHY_STARTUP_LOG=C:\temp\shadow_debug.log`
- then launch `ShadowOrography.exe`

The log records bootstrap failures early, including import/plugin errors before the UI appears.


## Build consigliato dell'eseguibile (Windows)

Per evitare errori come `ModuleNotFoundError: No module named 'pandas'`, usa lo spec già pronto nel repository:

1. Installa dipendenze progetto e tool di build:
   - `pip install -e .[dev]`
2. Verifica che pandas sia disponibile nell'ambiente usato per il build:
   - `python -c "import pandas; print(pandas.__version__)"`
3. Crea l'eseguibile con PyInstaller usando lo spec dedicato:
   - `python -m PyInstaller --clean --noconfirm shadow_orography.spec`

Lo spec usa `collect_all("pandas")` (imports + data + binaries) per ridurre i casi in cui il bundle non trova `pandas` a runtime.

### Comando rapido (.exe)

Da root progetto, nell'ambiente virtuale con dipendenze installate:

- `python -m PyInstaller --clean --noconfirm shadow_orography.spec`

L'eseguibile verrà generato in `dist/ShadowOrography.exe`.


Nota: se l'errore persiste, quasi sempre PyInstaller è stato lanciato da un interprete diverso da quello dove hai installato `pandas`.
   - `pyinstaller shadow_orography.spec`

Lo spec include i sottomoduli `pandas` necessari al runtime del bundle.
